<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- BEGIN head -->
<meta http-equiv="Expires" content="-1"/>
<meta http-equiv="Cache-Control" content="NO-CACHE"/>
<meta http-equiv="Pragma" content="NO-CACHE"/>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<!-- END head -->
</head>
<body>
<form action="#" onsubmit="window.onApplyNumFormat(this, 'apply'); return false">
<table class="Simple" style="width: 500px; font-size: 11px">
<tr>
	<td class="Simple" style="padding: 0px 6px 0px 0px">
	
		<select class="DeepBlueText" name="category" size="21" style="width: 110px" onchange="window.onChangeNumFormatCategory(this.form)" ondblclick="window.onApplyNumFormat(this.form)">
			<option value="general" selected="selected">常规</option>
			<option value="number">数字</option>
			<option value="currency">货币</option>
			<option value="accounting">会计</option>
			<option value="date">日期</option>
			<option value="time">时间</option>
			<option value="percentage">百分比</option>
			<option value="fraction">分数</option>
			<option value="scientific">科学</option>
			<option value="text">文字</option>
			<option value="custom">自定义</option>
		</select>

	</td>
	<td class="ToolboxRSection">

	<table width="100%">
	<tr>
	<td>
		<div class="ToolboxBlockTitle">
			<div category="general">常规</div>
			<div category="number" style="display: none">数字</div>
			<div category="currency" style="display: none">货币</div>
			<div category="accounting" style="display: none">会计</div>
			<div category="date" style="display: none">日期</div>
			<div category="time" style="display: none">时间</div>
			<div category="percentage" style="display: none">百分比</div>
			<div category="fraction" style="display: none">分数</div>
			<div category="scientific" style="display: none">科学</div>
			<div category="text" style="display: none">文字</div>
			<div category="custom" style="display: none">自定义</div>
			<div class="ToolboxBreakLine"></div>
		</div>
	</td>
	</tr>
	
	<tr>
	<td class="ToolboxRContentHolder">
		<div>
			<div category="general">自动选取适当的格式</div>
			<div category="number" style="display: none">以固定小数位显示</div>
			<div category="currency" style="display: none">以货币格式显示</div>
			<div category="accounting" style="display: none">以会计格式显示</div>
			<div category="date" style="display: none">设定日期和时间格式</div>
			<div category="time" style="display: none">设定时间格式</div>
			<div category="percentage" style="display: none">以百分数的形式显示</div>
			<div category="fraction" style="display: none">以分数形式显示(近似值)</div>
			<div category="scientific" style="display: none">用科学标记法表示大数值</div>
			<div category="text" style="display: none">直接显示所输入的数据</div>
			<div category="custom" style="display: none">以格式码自定义显示格式</div>
		</div>

		<div>
	
			<div category="general, text, checkbox" class="Remark">
				<br/>This category has no option
			</div>

			<div category="number, currency, accounting, percentage, scientific" style="display: none;">
				<em>小数位:</em>
				<select name="decimals">
					
	
		<option value="0">0</option>
		<option value="1">1</option>
		<option value="2">2</option>
		<option value="3">3</option>
		<option value="4">4</option>
		<option value="5">5</option>
		<option value="6">6</option>
		<option value="7">7</option>
		<option value="8">8</option>
		<option value="9">9</option>
		<option value="10">10</option>
		<option value="11">11</option>
		<option value="12">12</option>
		<option value="13">13</option>
		
	
		<option value="14">14</option>
		
	
		<option value="15">15</option>
		
	
		<option value="16">16</option>
		
	
		<option value="17">17</option>
		
	
		<option value="18">18</option>
		
	
		<option value="19">19</option>
		
	
		<option value="20">20</option>
		
	
		<option value="21">21</option>
		
	
		<option value="22">22</option>
		
	
		<option value="23">23</option>
		
	
		<option value="24">24</option>
		
	
		<option value="25">25</option>
		
	
		<option value="26">26</option>
		
	
		<option value="27">27</option>
		
	
		<option value="28">28</option>
		
	
		<option value="29">29</option>
		
	
		<option value="30">30</option>
		
	

				</select>
			</div>
				
			<div class="ToolboxBreakLine" style="width: 90%"></div>
			<div category="currency, accounting" style="display: none; margin-bottom: 10px">
				
				代号:<br/>
				<select name="currency" style="width: 100%">
					<option value='p|' selected="selected">沒有格式</option>
					<option value='p|"฿"'>฿ 泰珠 Baht</option>
					<option value='p|"R$"'>R$ 巴西雷亚尔</option>
					<option value='p|"₡"'>₡ 可隆 Colón</option>
					<option value='p|"₢"'>₢ 克鲁赛罗 Cruzeiro Real</option>
					<option value='p|"$"'>$ 国际货币</option>
					<option value='p|"₫"'>₫ 越南盾 Dông</option>
					<option value='p|"€"'>€ 欧罗 Euro(€123)</option>
					<option value='s|"€"'>€ 欧罗 Euro(123€)</option>
					<option value='p|"ƒ"'>ƒ 弗洛林币 Florin</option>
					<option value='p|"₣"'>₣ 法郎 French Franc</option>
					<option value='p|"₤"'>₤ 里拉 Lira</option>
					<option value='p|"₦"'>₦ 奈拉 Naira</option>
					<option value='p|"₧"'>₧ 比塞塔 Peseta</option>
					<option value='p|"£"'>£ 英镑 Pound</option>
					<option value='p|"₨"'>₨ 卢比 Rupee</option>
					<option value='p|"₪"'>₪ 新谢克尔 Sheqel</option>
					<option value='s|"₮"'>₮ 图格里克 Tugrug</option>
					<option value='p|"₩"'>₩ 朝鲜元</option>
					<option value='p|"Ұ"'>Ұ 人民币</option>
					<option value='p|"¥"'>¥ 日元</option>
					<option value='p|"¤"'>¤ 多用途的</option>
				</select>
			</div>

			<div category="number, currency" style="display: none;">
				<div class="rowSpaced">负数格式:</div>
				<select name="full" size="5" style="width: 100%;" ondblclick="window.onApplyNumFormat(this.form)">
					<option value="NNN" style="" selected="selected">-1230.00</option>
					<option value="NNN;[Red]-NNN" style="color: red">-1230.00</option>
					<option value="NNN;[Red]NNN" style="color: red">1230.00</option>
					<option value="NNN_);(NNN)" style="">(1230.00)</option>
					<option value="NNN_);[Red](NNN)" style="color: red">(1230.00)</option>
				</select>
			</div>

			<div category="number" class="rowSpaced" style="display: none;">
				<table><tr>
				<td>
					<input type="checkbox" name="separator"/>
				</td>
				<td>
					<label>Use 1000 Separator <em>(,)</em></label>
				</td></tr>
				</table>
			</div>
			
			<div category="date" style="display: none; margin-bottom: 10px">
				格式:<br/>
				<select name="date" size="10" style="width: 100%" ondblclick="window.onApplyNumFormat(this.form)">
				
	
	<option value="d/m/yy"selected="selected">d/m/yy</option>
	
	<option value="d/m/yyyy">d/m/yyyy</option>
	
	<option value="m/d/yy">m/d/yy</option>
	
	<option value="m/d/yyyy">m/d/yyyy</option>
	
	<option value="mmm-d-yy">mmm-d-yy</option>
	
	<option value="mmm-d-yyyy">mmm-d-yyyy</option>
	
	<option value="mmm-d">mmm-d</option>
	
	<option value="mm-d">mm-d</option>
	
	<option value="d/mmm">d/mmm</option>
	
	<option value="d/mm">d/mm</option>
	
	<option value="mm/d">mm/d</option>
	
	<option value="dd/mm/yy">dd/mm/yy</option>
	
	<option value="dd/mm/yyyy">dd/mm/yyyy</option>
	
	<option value="dd/mmm/yy">dd/mmm/yy</option>
	
	<option value="dd/mmm/yyyy">dd/mmm/yyyy</option>
	
	<option value="mm/dd/yy">mm/dd/yy</option>
	
	<option value="mm/dd/yyyy">mm/dd/yyyy</option>
	
	<option value="mmm-yy">mmm-yy</option>
	
	<option value="mmm-yyyy">mmm-yyyy</option>
	
	<option value="mmmm-yy">mmmm-yy</option>
	
	<option value="mmmm-yyyy">mmmm-yyyy</option>
	
	<option value="d/m/yy h:mm">d/m/yy h:mm</option>
	
	<option value="d/m/yyyy h:mm">d/m/yyyy h:mm</option>
	
	<option value="yyyy/mm/d">yyyy/mm/d</option>
	
	<option value="yyyy/mmm/d">yyyy/mmm/d</option>
	
	<option value="yyyy/mm/dd">yyyy/mm/dd</option>
	
	<option value="yyyy/mmm/dd">yyyy/mmm/dd</option>
	
	<option value="yyyy-mm-d">yyyy-mm-d</option>
	
	<option value="yyyy-mmm-d">yyyy-mmm-d</option>
	
	<option value="yyyy-mm-dd">yyyy-mm-dd</option>
	
	<option value="yyyy-mmm-dd">yyyy-mmm-dd</option>
	
	<option value="yy">yy</option>
	
	<option value="yyyy">yyyy</option>
	
	<option value="mmmm">mmmm</option>
	
	<option value="mmmm-yy">mmmm-yy</option>
	

				</select>
			</div>

			<div category="time" style="display: none; margin-bottom: 10px">
				格式:<br/>
				<select name="time" size="10" style="width: 100%" ondblclick="window.onApplyNumFormat(this.form)">
				
	
	<option value="h:mm AM/PM"selected="selected">h:mm AM/PM</option>
	
	<option value="h:mm:ss AM/PM">h:mm:ss AM/PM</option>
	
	<option value="h:mm">h:mm</option>
	
	<option value="h:mm:ss">h:mm:ss</option>
	
	<option value="d/m/yy h:mm">d/m/yy h:mm</option>
	
	<option value="[h]:mm">[h]:mm</option>
	
	<option value="[h]:mm:ss">[h]:mm:ss</option>
	
	<option value="mm:ss">mm:ss</option>
	
	<option value="mm:ss.0">mm:ss.0</option>
	
	<option value="[mm]:ss">[mm]:ss</option>
	
	<option value="[ss]">[ss]</option>
	

				</select>
			</div>

			<div category="fraction" style="display: none; margin-bottom: 10px">
				格式:<br/>
				<select name="fraction" size="10" style="width: 100%" ondblclick="window.onApplyNumFormat(this.form)">
				
	
	<option value="# ?/?"selected="selected"># ?/?</option>
	
	<option value="# ??/??"># ??/??</option>
	
	<option value="# ???/???"># ???/???</option>
	
	<option value="# ?/2"># ?/2</option>
	
	<option value="# ?/4"># ?/4</option>
	
	<option value="# ?/8"># ?/8</option>
	
	<option value="# ?/16"># ?/16</option>
	
	<option value="# ?/10"># ?/10</option>
	
	<option value="# ?/100"># ?/100</option>
	

				</select>
			</div>

			<div category="custom" style="display: none; margin-bottom: 10px">
				格式:<br/>
				<select size="10" style="width: 100%" id="numformatCategoryCustomSelect" onchange="this.form.elements['code'].value = this.value" ondblclick="window.onApplyNumFormat(this.form)">
				
	
	<option value="General">General</option>
	
	<option value="0">0</option>
	
	<option value="0.00">0.00</option>
	
	<option value="#,##0">#,##0</option>
	
	<option value="#,##0.00">#,##0.00</option>
	
	<option value="#,##0_);(#,##0)">#,##0_);(#,##0)</option>
	
	<option value="#,##0_);[Red](#,##0)">#,##0_);[Red](#,##0)</option>
	
	<option value="#,##0.00_);(#,##0.00)">#,##0.00_);(#,##0.00)</option>
	
	<option value="#,##0.00_);[Red](#,##0.00)">#,##0.00_);[Red](#,##0.00)</option>
	
	<option value="0.0">0.0</option>
	
	<option value="&quot;$&quot;#,##0">"$"#,##0</option>
	
	<option value="&quot;$&quot;#,##0_);(&quot;$&quot;#,##0)">"$"#,##0_);("$"#,##0)</option>
	
	<option value="&quot;$&quot;#,##0_);[Red](&quot;$&quot;#,##0)">"$"#,##0_);[Red]("$"#,##0)</option>
	
	<option value="&quot;$&quot;#,##0.00">"$"#,##0.00</option>
	
	<option value="&quot;$&quot;#,##0.00_);(&quot;$&quot;#,##0.00)">"$"#,##0.00_);("$"#,##0.00)</option>
	
	<option value="&quot;$&quot;#,##0.00_);[Red](&quot;$&quot;#,##0.00)">"$"#,##0.00_);[Red]("$"#,##0.00)</option>
	
	<option value="_(&quot;$&quot;* #,##0_);_(&quot;$&quot;* (#,##0);_(&quot;$&quot;* &quot;-&quot;_);_(@_)">_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)</option>
	
	<option value="_(* #,##0_);_(* (#,##0);_(* &quot;-&quot;_);_(@_)">_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)</option>
	
	<option value="_(&quot;$&quot;* #,##0.00_);_(&quot;$&quot;* (#,##0.00);_(&quot;$&quot;* &quot;-&quot;??_);_(@_)">_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)</option>
	
	<option value="_(* #,##0.00_);_(* (#,##0.00);_(* &quot;-&quot;??_);_(@_)">_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)</option>
	
	<option value="d/m/yy">d/m/yy</option>
	
	<option value="d/m/yyyy">d/m/yyyy</option>
	
	<option value="m/d/yy">m/d/yy</option>
	
	<option value="m/d/yyyy">m/d/yyyy</option>
	
	<option value="mmm-d-yy">mmm-d-yy</option>
	
	<option value="mmm-d-yyyy">mmm-d-yyyy</option>
	
	<option value="mmm-d">mmm-d</option>
	
	<option value="mm-d">mm-d</option>
	
	<option value="d/mmm">d/mmm</option>
	
	<option value="d/mm">d/mm</option>
	
	<option value="mm/d">mm/d</option>
	
	<option value="dd/mm/yy">dd/mm/yy</option>
	
	<option value="dd/mm/yyyy">dd/mm/yyyy</option>
	
	<option value="dd/mmm/yy">dd/mmm/yy</option>
	
	<option value="dd/mmm/yyyy">dd/mmm/yyyy</option>
	
	<option value="mm/dd/yy">mm/dd/yy</option>
	
	<option value="mm/dd/yyyy">mm/dd/yyyy</option>
	
	<option value="mmm-yy">mmm-yy</option>
	
	<option value="mmm-yyyy">mmm-yyyy</option>
	
	<option value="mmmm-yy">mmmm-yy</option>
	
	<option value="mmmm-yyyy">mmmm-yyyy</option>
	
	<option value="d/m/yy h:mm">d/m/yy h:mm</option>
	
	<option value="d/m/yyyy h:mm">d/m/yyyy h:mm</option>
	
	<option value="yyyy/mm/d">yyyy/mm/d</option>
	
	<option value="yyyy/mmm/d">yyyy/mmm/d</option>
	
	<option value="yyyy/mm/dd">yyyy/mm/dd</option>
	
	<option value="yyyy/mmm/dd">yyyy/mmm/dd</option>
	
	<option value="yyyy-mm-d">yyyy-mm-d</option>
	
	<option value="yyyy-mmm-d">yyyy-mmm-d</option>
	
	<option value="yyyy-mm-dd">yyyy-mm-dd</option>
	
	<option value="yyyy-mmm-dd">yyyy-mmm-dd</option>
	
	<option value="yy">yy</option>
	
	<option value="yyyy">yyyy</option>
	
	<option value="mmmm">mmmm</option>
	
	<option value="mmmm-yy">mmmm-yy</option>
	
	<option value="h:mm AM/PM">h:mm AM/PM</option>
	
	<option value="h:mm:ss AM/PM">h:mm:ss AM/PM</option>
	
	<option value="h:mm">h:mm</option>
	
	<option value="h:mm:ss">h:mm:ss</option>
	
	<option value="d/m/yy h:mm">d/m/yy h:mm</option>
	
	<option value="[h]:mm">[h]:mm</option>
	
	<option value="[h]:mm:ss">[h]:mm:ss</option>
	
	<option value="mm:ss">mm:ss</option>
	
	<option value="mm:ss.0">mm:ss.0</option>
	
	<option value="[mm]:ss">[mm]:ss</option>
	
	<option value="[ss]">[ss]</option>
	
	<option value="# ?/?"># ?/?</option>
	
	<option value="# ??/??"># ??/??</option>
	
	<option value="# ???/???"># ???/???</option>
	
	<option value="# ?/2"># ?/2</option>
	
	<option value="# ?/4"># ?/4</option>
	
	<option value="# ?/8"># ?/8</option>
	
	<option value="# ?/16"># ?/16</option>
	
	<option value="# ?/10"># ?/10</option>
	
	<option value="# ?/100"># ?/100</option>
	

				</select>
			</div>

			<div category="custom" style="display: none; margin-bottom: 10px">
				格式码:<br/>
				<input type="text" name="code" defaultValue="" style="width: 100%; margin: 0px;"/>
			</div>
		
		</div>

	</td>
	</tr>
	</table>
	</td>
</tr>
</table>
<div class="ToolboxBreakLine"></div>
<div class="buttonArea">
		<input type="button" class="InputButton" value=" 确定 " onclick="window.onApplyNumFormat(this.form, 'ok')"/>
		<input type="button" class="InputButton" value="取消" onclick="grid.onCancelNumFormat()" />
		<input type="submit" class="InputButton" value="Apply" />
</div>
</form>



<script type="text/javascript">

if (editgrid.widgets == null)
	editgrid.widgets = {};

if (editgrid.widgets.numFormat == null) {
	editgrid.widgets.numFormat = { init: function(grid) {

window.onChangeNumFormatCategory = function(form) {
	var selected = form.elements["category"].value;
	var divs = form.getElementsByTagName("div");
	for (var i = 0; i < divs.length; i++) {
		if (divs[i].getAttribute("category") != null) {
			var categories = divs[i].getAttribute("category").split(",");
			var display = false;
			for (var j = 0; j < categories.length; j++) {
				if (new RegExp("\s*" + selected + "\s*").test(categories[j])) {
					display = true;
					break;
				}
			}
			divs[i].style.display = display ? "" : "none";
		}
	}
	
	var defaults = { decimals: "2" };
	var locale   = grid.workbook.bookSessionInfo.locale;
	var settings = locale && locale[selected] ? locale[selected] : defaults;
	for (var key in settings) {
		var el = form.elements[key];
		if (el)
			el.value = settings[key];
	}
}

window.onApplyNumFormat = function(form, cmd) {
	var decimals = function() {
		count = value("decimals");
		str = count == 0 ? "" : ".";
		for (var i = 0; i < count; i++)
			str += "0";
		return str;
	}
	var value = function(name) {
		return form.elements[name].value;
	}
	var element = function(name) {
		return form.elements[name];
	}
	var exists = function(format) {
		var options = std.dom.element('numformatCategoryCustomSelect').options;
		for (var i=0; i<options.length; ++i) {
			if (options[i].value == format) { return true }
		}
		return false;
	}
	var addCustom = function(format) {
		var option = std.dom.newElement('OPTION', null, { value: format, text: format }); 
		std.dom.addOption(std.dom.element('numformatCategoryCustomSelect'), option);
		option.selected = true;
	}
	var format = "General";
	switch (form.elements["category"].value) {

		case "general":
			format = "General";
			break;

		case "number":
			format = value("full");
			format = format.replace(/NNN/g, (element("separator").checked ? "#,##0" : "0") + decimals());
			break;

		case "currency":
			var currency = value("currency").split('|');
			format = value("full");
			format = format.replace(/NNN/g, currency[0] == 'p' ? '$NNN' : 'NNN$');
			format = format.replace(/NNN/g, "#,##0" + decimals());
			format = format.replace(/\$/g, currency[1]);
			break;

		case "accounting":
			var currency = value("currency").split('|');
			format = currency[0] == 'p' ? '_($ * NNN_);_($ * (NNN);_($ * "-"_);_(@_)' : '_(NNN * $_);_((NNN) * $;_("-" * $_);_(@_)';
			format = format.replace(/NNN/g, "#,##0" + decimals());
			format = format.replace(/\$/g, currency[1]);
			break;

		case "date":
			format = value("date");
			break;

		case "time":
			format = value("time");
			break;

		case "percentage":
			format = "0" + decimals() + "%";
			break;

		case "fraction":
			format = value("fraction");
			break;

		case "scientific":
			format = "0" + decimals() + "E+00";
			break;

		case "text":
			format = "@";
			break;

		case "custom":
			format = value("code");
			if (format == '') { return }
			if (!exists(format)) { addCustom(format) }
			break;

		default:
			break;
	
	}

	if (typeof(grid) == "object") {
		if (cmd == 'apply')
			grid.onApplyNumFormat(format);
		else
			grid.onOkNumFormat(format);
	} else {
		alert(format);
	}
}
}}}

</script>


</body>

</html>

